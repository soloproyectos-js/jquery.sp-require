/*! jQuery.spRequire v0.2.0 | Copyright (c) 2015 Gonzalo Chumillas | https://github.com/soloproyectos-js/jquery.sp-require/blob/master/LICENSE */
!function(r){r.spRequireConfig=function(){this._libraries={}},r.spRequireConfig.prototype._errorMessage="The '%library-name%' library is not well formed",r.spRequireConfig.prototype._libraries,r.spRequireConfig.prototype._parse=function(e){var t=this;r.isPlainObject(e)||r.error("Invalid config object"),this._libraries={};var s=e.hasOwnProperty("libraries")?e.libraries:{},i=r.type(s);"object"!=i&&r.error("Invalid 'libraries' property. Expected object, given "+i),r.each(s,function(e,i){var o={sources:{js:[],css:[]},requires:[]};try{t._parseAttr(i,"async",!0),o.async="boolean"==r.type(i.async)?i.async:!0,o.sources.js=t._parseMixedAttr(s,e,{}),"object"==r.type(o.sources.js)&&(o.sources.js=t._parseMixedAttr(o.sources.js,"sources",{}),"object"==r.type(o.sources.js)&&(o.sources.css=t._parseMixedAttr(o.sources.js,"css"),o.sources.js=t._parseMixedAttr(o.sources.js,"js")),o.requires=t._parseMixedAttr(i,"requires"))}catch(n){r.error(t._errorMessage.replace("%library-name%",e)+":\n"+n.message)}t._libraries[e]=o})},r.spRequireConfig.prototype._parseAttr=function(e,t,s){var i=e.hasOwnProperty(t)?e[t]:s;return r.type(i)!=r.type(s)&&r.error("The '"+t+"' property was expected to be '"+r.type(s)+"'"),i},r.spRequireConfig.prototype._parseMixedAttr=function(e,t,s){void 0===s&&(s=[]);var i=e.hasOwnProperty(t)?e[t]:s,o=r.type(i);if("string"==o)i=[i];else if("array"==o)r.each(i,function(e,s){"string"!=r.type(s)&&r.error("The '"+t+"' property was expected to be 'string', an 'array of strings' or an 'object'\nPlease check the documentation")});else if(arguments.length<3||o!=r.type(s)){var n="The '"+t+"' property was expected to be 'string' or an 'array of strings'";arguments.length>=3&&(n="The '"+t+"' property was expected to be 'string', an 'array of strings' or an '"+r.type(s)+"'"),n+="\nPlease check the documentation",r.error(n)}return i},r.spRequireConfig.prototype.getLibraries=function(){return this._libraries}}(jQuery),function(r){r.spRequireLoader=function(){this._loaders=[]},r.spRequireLoader.prototype._loaders=null,r.spRequireLoader.prototype.addLoader=function(r){this._loaders.push(r)},r.spRequireLoader.prototype.load=function(){var e=this,t=new r.Deferred,s=this._loaders.length,i=!0;return s>0?r.each(this._loaders,function(){this.call(e).fail(function(){i=!1}).always(function(){s--,1>s&&r(function(){t[i?"resolve":"reject"]()})})}):r(function(){t.resolve()}),t.promise()},r.spRequireLoader.prototype.syncLoad=function(){function e(o){i>o?t._loaders[o].call(t).done(function(){e(o+1)}).fail(function(){r(function(){s.reject()})}):r(function(){s.resolve()})}var t=this,s=new r.Deferred,i=this._loaders.length;return i>0?e(0):r(function(){s.resolve()}),s}}(jQuery),function(r){var e=function(r){this.url=r,this.state="pending",this.deferrers=[]};e.prototype.url="",e.prototype.state="pending",e.prototype.deferrers=[],r.spRequireUrlLoader=function(){this._links=[]},r.spRequireUrlLoader._instance=null,r.spRequireUrlLoader.prototype._links=[],r.spRequireUrlLoader.getInstance=function(){return null===r.spRequireUrlLoader._instance&&(r.spRequireUrlLoader._instance=new r.spRequireUrlLoader),r.spRequireUrlLoader._instance},r.spRequireUrlLoader.prototype.load=function(t,s){var i=this,o=new r.Deferred,n=this._getAbsoluteUrl(t),a=this._searchLink(n);if(null===a){a=new e(n),this._links.push(a);var u=s.call(this,t);void 0===u&&(u=(new r.Deferred).resolve().promise()),u.always(function(){a.state=u.state(),i._resolve()})}return a.deferrers.push(o),this._resolve(),o.promise()},r.spRequireUrlLoader.prototype._resolve=function(){r.each(this._links,function(){var e=this;r.each(this.deferrers,function(){"resolved"==e.state?this.resolve():"rejected"==e.state&&this.reject()})})},r.spRequireUrlLoader.prototype._searchLink=function(e){var t=null;return r.each(this._links,function(){return this.url==e?(t=this,!1):void 0}),t},r.spRequireUrlLoader.prototype._getAbsoluteUrl=function(r){var e=document.createElement("a");return e.href=r,e.href}}(jQuery),function(r){r.spRequireLibrary=function(){this._isAsync=!0,this._libraries=[],this._jsSources=[],this._cssSources=[],this._urlLoader=r.spRequireUrlLoader.getInstance()},r.spRequireLibrary._circularLibraries=[],r.spRequireLibrary.prototype._urlLoader=null,r.spRequireLibrary.prototype._isAsync=!0,r.spRequireLibrary.prototype._libraries=null,r.spRequireLibrary.prototype._jsSources=null,r.spRequireLibrary.prototype._cssSources=null,r.spRequireLibrary.prototype.isAsync=function(){return this._isAsync},r.spRequireLibrary.prototype.setAsync=function(r){this._isAsync=r},r.spRequireLibrary.prototype.addJs=function(r){this._jsSources.push(r)},r.spRequireLibrary.prototype.addCss=function(r){this._cssSources.push(r)},r.spRequireLibrary.prototype.addLibrary=function(r){this._libraries.push(r)},r.spRequireLibrary.prototype.load=function(){this._loadCssSources();var e=new r.spRequireLoader(this);return e.addLoader(r.proxy(this._loadLibraries,this)),e.addLoader(r.proxy(this._loadJsSources,this)),e[this._isAsync?"load":"syncLoad"]()},r.spRequireLibrary.prototype._loadLibraries=function(){r.spRequireLibrary._circularLibraries.push(this);var e=new r.spRequireLoader(this);return r.each(this._libraries,function(){r.inArray(this,r.spRequireLibrary._circularLibraries)<0&&e.addLoader(r.proxy(this.load,this))}),e.load()},r.spRequireLibrary.prototype._loadJsSources=function(){var e=this,t=new r.spRequireLoader(this);return r.each(this._jsSources,function(s,i){t.addLoader(function(){return e._urlLoader.load(i,function(){return r.ajax({url:i,dataType:"script",cache:!0}).fail(function(r,e,t){"parsererror"==e&&console.error(i+"\n"+t)})})})}),t.load()},r.spRequireLibrary.prototype._loadCssSources=function(){var e=this;r.each(e._cssSources,function(t,s){e._urlLoader.load(s,function(){r("head").append(r('<link rel="stylesheet" type="text/css" />').attr("href",s))})})}}(jQuery),function(r){var e={},t=!0,s={},i={init:function(e,i){if(!t)return(new r.Deferred).promise();"string"==r.type(e)&&(e=[e]),("array"!=r.type(e)||arguments.length>1&&"function"!=r.type(i))&&r.error("Invalid arguments. Please check the documentation");var o=new r.spRequireLibrary;return r.each(e,function(e,t){var i=s[t];void 0===i&&r.error("Library not found: "+t),o.addLibrary(s[t])}),o.load().done(i)},config:function(i){if(void 0!==i){var o=[],n=new r.spRequireConfig(i);t=!0;try{n._parse(i),o=n.getLibraries()}catch(a){throw t=!1,new Error(a)}s={},r.each(o,function(e,t){var i=t.sources.js,o=t.sources.css,n=new r.spRequireLibrary;n.setAsync(t.async),r.each(i,function(r,e){n.addJs(e)}),r.each(o,function(r,e){n.addCss(e)}),s[e]=n}),r.each(o,function(e,i){var o=i.requires;if(void 0!==o){var n=s[e];r.each(o,function(e,i){var o=s[i];void 0===o&&(t=!1,r.error("Library not found: "+i)),n.addLibrary(o)})}}),e=i}return e}};r.require=function(){var e=Array.prototype.slice.call(arguments),t="init";e.length>0&&Object.keys(i).indexOf(e[0])>-1&&(t=e[0],e=e.slice(1));var s=i[t];return void 0===s&&r.error("Method not found: "+t),s.apply(this,e)}}(jQuery);