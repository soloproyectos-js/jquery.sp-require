/*! jQuery.spRequire v0.3.0 | Copyright (c) 2015 Gonzalo Chumillas | https://github.com/soloproyectos-js/jquery.sp-require/blob/master/LICENSE */
!function(e){e.spRequireConfig=function(){this._libraries={}},e.spRequireConfig.prototype._errorMessage="The '%library-name%' library is not well formed",e.spRequireConfig.prototype._libraries,e.spRequireConfig.prototype._parse=function(r){var t=this;e.isPlainObject(r)||e.error("Invalid config object"),this._libraries={};var s=r.hasOwnProperty("libraries")?r.libraries:{},o=e.type(s);"object"!=o&&e.error("Invalid 'libraries' property. Expected object, given "+o),e.each(s,function(r,o){var i={sources:{js:[],css:[]},requires:[]};try{t._parseAttr(o,"async",!0),i.async="boolean"==e.type(o.async)?o.async:!0,i.sources.js=t._parseMixedAttr(s,r,{}),"object"==e.type(i.sources.js)&&(i.sources.js=t._parseMixedAttr(i.sources.js,"sources",{}),"object"==e.type(i.sources.js)&&(i.sources.css=t._parseMixedAttr(i.sources.js,"css"),i.sources.js=t._parseMixedAttr(i.sources.js,"js")),i.requires=t._parseMixedAttr(o,"requires"))}catch(n){e.error(t._errorMessage.replace("%library-name%",r)+":\n"+n.message)}t._libraries[r]=i})},e.spRequireConfig.prototype._parseAttr=function(r,t,s){var o=r.hasOwnProperty(t)?r[t]:s;return e.type(o)!=e.type(s)&&e.error("The '"+t+"' property was expected to be '"+e.type(s)+"'"),o},e.spRequireConfig.prototype._parseMixedAttr=function(r,t,s){void 0===s&&(s=[]);var o=r.hasOwnProperty(t)?r[t]:s,i=e.type(o);if("string"==i)o=[o];else if("array"==i)e.each(o,function(r,s){"string"!=e.type(s)&&e.error("The '"+t+"' property was expected to be 'string', an 'array of strings' or an 'object'\nPlease check the documentation")});else if(arguments.length<3||i!=e.type(s)){var n="The '"+t+"' property was expected to be 'string' or an 'array of strings'";arguments.length>=3&&(n="The '"+t+"' property was expected to be 'string', an 'array of strings' or an '"+e.type(s)+"'"),n+="\nPlease check the documentation",e.error(n)}return o},e.spRequireConfig.prototype.getLibraries=function(){return this._libraries}}(jQuery),function(e){e.spRequireLoader=function(){this._loaders=[]},e.spRequireLoader.prototype._loaders=null,e.spRequireLoader.prototype.addLoader=function(e){this._loaders.push(e)},e.spRequireLoader.prototype.load=function(){var r=this,t=new e.Deferred,s=this._loaders.length,o=!0;return s>0?e.each(this._loaders,function(){this.call(r).fail(function(){o=!1}).always(function(){s--,1>s&&e(function(){t[o?"resolve":"reject"]()})})}):e(function(){t.resolve()}),t.promise()},e.spRequireLoader.prototype.syncLoad=function(){function r(i){o>i?t._loaders[i].call(t).done(function(){r(i+1)}).fail(function(){e(function(){s.reject()})}):e(function(){s.resolve()})}var t=this,s=new e.Deferred,o=this._loaders.length;return o>0?r(0):e(function(){s.resolve()}),s}}(jQuery),function(e){var r=function(e){this.id=e,this.state="pending",this.deferrers=[]};r.prototype.id=null,r.prototype.state="pending",r.prototype.deferrers=[],e.spRequireCacheLoader=function(){this._items=[]},e.spRequireCacheLoader.prototype._items=[],e.spRequireCacheLoader.prototype.load=function(t,s){var o=this,i=new e.Deferred,n=this._searchItem(t);if(null===n){n=new r(t),this._items.push(n);var a=s.call(this,n);void 0===a&&(a=(new e.Deferred).resolve().promise()),a.always(function(){n.state=a.state(),o._resolve()})}return n.deferrers.push(i),this._resolve(),i.promise()},e.spRequireCacheLoader.prototype._resolve=function(){e.each(this._items,function(){var r=this;e.each(this.deferrers,function(){"resolved"==r.state?this.resolve():"rejected"==r.state&&this.reject()})})},e.spRequireCacheLoader.prototype._searchItem=function(r){var t=null;return e.each(this._items,function(){return this.id===r?(t=this,!1):void 0}),t}}(jQuery),function(e){e.spRequireLibrary=function(){this._isAsync=!0,this._libraries=[],this._jsSources=[],this._cssSources=[],this._cacheLoader=e.spRequire("__cacheLoader__")},e.spRequireLibrary.prototype._cacheLoader=null,e.spRequireLibrary.prototype._isAsync=!0,e.spRequireLibrary.prototype._libraries=null,e.spRequireLibrary.prototype._jsSources=null,e.spRequireLibrary.prototype._cssSources=null,e.spRequireLibrary.prototype.isAsync=function(){return this._isAsync},e.spRequireLibrary.prototype.setAsync=function(e){this._isAsync=e},e.spRequireLibrary.prototype.addJs=function(e){this._jsSources.push(this._getAbsoluteUrl(e))},e.spRequireLibrary.prototype.addCss=function(e){this._cssSources.push(this._getAbsoluteUrl(e))},e.spRequireLibrary.prototype.addLibrary=function(e){this._libraries.push(e)},e.spRequireLibrary.prototype.load=function(){this._loadCssSources();var r=new e.spRequireLoader;return r.addLoader(e.proxy(this._loadLibraries,this)),r.addLoader(e.proxy(this._loadJsSources,this)),r[this._isAsync?"load":"syncLoad"]()},e.spRequireLibrary.prototype._loadLibraries=function(){var r=this,t=new e.spRequireLoader;return e.each(this._libraries,function(s,o){t.addLoader(e.proxy(r._cacheLoader.load,r._cacheLoader,o,e.proxy(o.load,o)))}),t.load()},e.spRequireLibrary.prototype._loadJsSources=function(){var r=this,t=new e.spRequireLoader;return e.each(this._jsSources,function(s,o){t.addLoader(function(){return r._cacheLoader.load(o,function(){return e.ajax({url:o,dataType:"script",cache:!0}).fail(function(e,r,t){"parsererror"==r&&console.error(o+"\n"+t)})})})}),t.load()},e.spRequireLibrary.prototype._loadCssSources=function(){var r=this;e.each(r._cssSources,function(t,s){r._cacheLoader.load(s,function(){e("head").append(e('<link rel="stylesheet" type="text/css" />').attr("href",s))})})},e.spRequireLibrary.prototype._getAbsoluteUrl=function(e){var r=document.createElement("a");return r.href=e,r.href}}(jQuery),function(e){var r={},t=!0,s={},o={__cacheLoader__:function(){return void 0===window.__cacheLoader__&&(window.__cacheLoader__=new e.spRequireCacheLoader),window.__cacheLoader__},init:function(r,o){if(!t)return(new e.Deferred).promise();"string"==e.type(r)&&(r=[r]),("array"!=e.type(r)||arguments.length>1&&"function"!=e.type(o))&&e.error("Invalid arguments. Please check the documentation");var i=new e.spRequireLibrary;return i.name="_main_package",e.each(r,function(r,t){var o=s[t];void 0===o&&e.error("Library not found: "+t),i.addLibrary(s[t])}),i.load().done(o)},config:function(o){if(void 0!==o){var i=[],n=new e.spRequireConfig(o);t=!0;try{n._parse(o),i=n.getLibraries()}catch(a){throw t=!1,new Error(a)}s={},e.each(i,function(r,t){var o=t.sources.js,i=t.sources.css,n=new e.spRequireLibrary;n.name=r,n.setAsync(t.async),e.each(o,function(e,r){n.addJs(r)}),e.each(i,function(e,r){n.addCss(r)}),s[r]=n}),e.each(i,function(r,o){var i=o.requires;if(void 0!==i){var n=s[r];e.each(i,function(r,o){var i=s[o];void 0===i&&(t=!1,e.error("Library not found: "+o)),n.addLibrary(i)})}}),r=o}return r}};e.spRequire=function(){var r=Array.prototype.slice.call(arguments),t="init";r.length>0&&Object.keys(o).indexOf(r[0])>-1&&(t=r[0],r=r.slice(1));var s=o[t];return void 0===s&&e.error("Method not found: "+t),s.apply(this,r)}}(jQuery);